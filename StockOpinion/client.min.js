function htmlEncode(t){var e=$("<div />").text(t).html();return e}function setAvatar(t){$("#avatar").val(t)}$(function(){function t(t,e){var a=e,n=a.getContext("2d"),s={scaleBeginAtZero:!1,animation:!1};new Chart(n).Bar(t,s)}var e=$.connection.chatHub;$(document).ready(function(){$("#launch").click(),setTimeout(function(){$("#start").click()},500),$("#message").focus()}),e.client.addNewMessageToPage=function(e,a){var n=new Array,s=new Array,l=new Array;$.each(e.fieldsList,function(){n.push(this.symbol),s.push(this.price),l.push(this.chg_percent)});var i={labels:n,datasets:[{label:"My First dataset",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:s}]},r={labels:n,datasets:[{label:"My First dataset",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:l}]};t(i,document.getElementById("myChart")),t(r,document.getElementById("myBarChart")),$("#clientCount").html(a.toString())},e.client.addNewMessage=function(t,e,a){$("#discussion").prepend('<li class="collection-item avatar" style = "overflow: auto"><img src = "images/'+(""!==a?htmlEncode(a):"default.png")+'" alt="" class="circle"><span class="title"> '+htmlEncode(t)+" </span><p>"+htmlEncode(e)+"</p></li>")},$.connection.hub.start().done(function(){$("#start").click(function(){$("#discussion").html(""),e.server.send()}),$("#sendmessage").click(function(){e.server.sendMessage($("#username").val(),$("#message").val(),$("#avatar").val()),$("#message").val("").focus()})})});